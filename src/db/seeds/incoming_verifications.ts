import { db } from '@/db';
import { incomingVerifications } from '@/db/schema';

async function main() {
    const now = new Date();
    
    const getRelativeDate = (daysAgo: number, hoursAgo: number = 0, minutesAgo: number = 0): string => {
        const date = new Date(now);
        date.setDate(date.getDate() - daysAgo);
        date.setHours(date.getHours() - hoursAgo);
        date.setMinutes(date.getMinutes() - minutesAgo);
        return date.toISOString();
    };

    const sampleVerifications = [
        {
            txid: 'a1b2c3d4e5f6789012345678901234567890123456789012345678901234abcd',
            currency: 'BTC',
            matchedAddress: 'bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh',
            amountSats: 50000000,
            amountFloat: 0.5,
            confirmed: true,
            confirmedAt: getRelativeDate(7),
            credited: true,
            creditedAt: getRelativeDate(7),
            firstSeen: getRelativeDate(8),
            lastChecked: getRelativeDate(7),
            meta: '{"block_height": 820000, "confirmations": 144, "vout_index": 0}',
            createdAt: getRelativeDate(8),
            updatedAt: getRelativeDate(7),
            userId: 1,
            retryCount: 0,
            errorMessage: null,
        },
        {
            txid: 'b2c3d4e5f6789012345678901234567890123456789012345678901234abcde',
            currency: 'BTC',
            matchedAddress: 'bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh',
            amountSats: 25000000,
            amountFloat: 0.25,
            confirmed: true,
            confirmedAt: getRelativeDate(2),
            credited: false,
            creditedAt: null,
            firstSeen: getRelativeDate(3),
            lastChecked: getRelativeDate(2),
            meta: '{"block_height": 821500, "confirmations": 48, "vout_index": 1}',
            createdAt: getRelativeDate(3),
            updatedAt: getRelativeDate(2),
            userId: 2,
            retryCount: 0,
            errorMessage: null,
        },
        {
            txid: 'c3d4e5f6789012345678901234567890123456789012345678901234abcdef0',
            currency: 'BTC',
            matchedAddress: 'bc1qar0srrr7xfkvy5l643lydnw9re59gtzzwf5mdq',
            amountSats: 10000000,
            amountFloat: 0.1,
            confirmed: false,
            confirmedAt: null,
            credited: false,
            creditedAt: null,
            firstSeen: getRelativeDate(0, 1),
            lastChecked: getRelativeDate(0, 1),
            meta: '{"confirmations": 0, "in_mempool": true}',
            createdAt: getRelativeDate(0, 1),
            updatedAt: getRelativeDate(0, 1),
            userId: 3,
            retryCount: 1,
            errorMessage: null,
        },
        {
            txid: 'd4e5f6789012345678901234567890123456789012345678901234abcdef01',
            currency: 'BTC',
            matchedAddress: 'bc1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t4',
            amountSats: 0,
            amountFloat: 0.0,
            confirmed: false,
            confirmedAt: null,
            credited: false,
            creditedAt: null,
            firstSeen: getRelativeDate(5),
            lastChecked: getRelativeDate(5),
            meta: '{}',
            createdAt: getRelativeDate(5),
            updatedAt: getRelativeDate(5),
            userId: null,
            retryCount: 3,
            errorMessage: 'Transaction not found on blockchain',
        },
        {
            txid: '0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef',
            currency: 'ETH',
            matchedAddress: '0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb',
            amountSats: 500000000000000000,
            amountFloat: 0.5,
            confirmed: true,
            confirmedAt: getRelativeDate(10),
            credited: true,
            creditedAt: getRelativeDate(10),
            firstSeen: getRelativeDate(11),
            lastChecked: getRelativeDate(10),
            meta: '{"block_number": 18500000, "confirmations": 720, "gas_used": "21000"}',
            createdAt: getRelativeDate(11),
            updatedAt: getRelativeDate(10),
            userId: 1,
            retryCount: 0,
            errorMessage: null,
        },
        {
            txid: 'd0ge1234567890abcdef1234567890abcdef1234567890abcdef1234567890ab',
            currency: 'DOGE',
            matchedAddress: 'DH5yaieqoZN36fDVciNyRueRGvGLR3mr7L',
            amountSats: 100000000000,
            amountFloat: 1000.0,
            confirmed: true,
            confirmedAt: getRelativeDate(1),
            credited: false,
            creditedAt: null,
            firstSeen: getRelativeDate(2),
            lastChecked: getRelativeDate(1),
            meta: '{"block_height": 4850000, "confirmations": 96, "vout_index": 0}',
            createdAt: getRelativeDate(2),
            updatedAt: getRelativeDate(1),
            userId: 2,
            retryCount: 0,
            errorMessage: null,
        },
        {
            txid: '0xabcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890',
            currency: 'ETH',
            matchedAddress: '0x8e215d06ea7ec1fdb4fc5fd21768f4b34ee92ef4',
            amountSats: 250000000000000000,
            amountFloat: 0.25,
            confirmed: false,
            confirmedAt: null,
            credited: false,
            creditedAt: null,
            firstSeen: getRelativeDate(0, 0, 30),
            lastChecked: getRelativeDate(0, 0, 30),
            meta: '{"confirmations": 0, "gas_price": "25000000000", "nonce": 42}',
            createdAt: getRelativeDate(0, 0, 30),
            updatedAt: getRelativeDate(0, 0, 30),
            userId: 3,
            retryCount: 0,
            errorMessage: null,
        },
        {
            txid: 'e5f6789012345678901234567890123456789012345678901234abcdef012345',
            currency: 'BTC',
            matchedAddress: 'bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh',
            amountSats: 100000000,
            amountFloat: 1.0,
            confirmed: true,
            confirmedAt: getRelativeDate(14),
            credited: true,
            creditedAt: getRelativeDate(14),
            firstSeen: getRelativeDate(15),
            lastChecked: getRelativeDate(14),
            meta: '{"block_height": 818000, "confirmations": 288, "vout_index": 2, "fee_sats": 5000}',
            createdAt: getRelativeDate(15),
            updatedAt: getRelativeDate(14),
            userId: 1,
            retryCount: 0,
            errorMessage: null,
        },
    ];

    await db.insert(incomingVerifications).values(sampleVerifications);
    
    console.log('✅ Incoming verifications seeder completed successfully');
}

main().catch((error) => {
    console.error('❌ Seeder failed:', error);
});